<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Node.jsæœåŠ¡ç«¯å¼€å‘å®ä¾‹ - å¤ä»£é©¿ç«™ç³»ç»Ÿ</title>
    <style>
        body {
            font-family: "Microsoft YaHei", Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            min-height: 100vh;
            color: #ecf0f1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            color: #2c3e50;
        }

        h1 {
            color: #2c3e50;
            text-align: center;
            border-bottom: 3px solid #e74c3c;
            padding-bottom: 15px;
            margin-bottom: 30px;
            font-size: 2.8em;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .post-station-header {
            background: linear-gradient(45deg, #2c3e50, #34495e, #3498db, #2980b9);
            background-size: 400% 400%;
            animation: gradientShift 6s ease infinite;
            color: white;
            padding: 25px;
            text-align: center;
            border-radius: 15px;
            margin: 20px 0;
            font-weight: bold;
            font-size: 1.4em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        @keyframes gradientShift {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        .server-demo {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
        }

        .server-status {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .status-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #e74c3c;
            animation: pulse 2s ease-in-out infinite;
        }

        .status-indicator.online {
            background: #27ae60;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        .api-demo {
            background: linear-gradient(135deg, #8e44ad, #9b59b6);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
        }

        .api-endpoint {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .api-endpoint:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateX(10px);
        }

        .api-response {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            max-height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
        }

        .file-system-demo {
            background: linear-gradient(135deg, #e67e22, #f39c12);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
        }

        .file-tree {
            background: rgba(255, 255, 255, 0.2);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
        }

        .file-item {
            padding: 5px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-item:hover {
            background: rgba(255, 255, 255, 0.1);
            padding-left: 10px;
        }

        .file-item.folder {
            font-weight: bold;
            color: #f1c40f;
        }

        .file-item.file {
            color: #ecf0f1;
            margin-left: 20px;
        }

        .middleware-demo {
            background: linear-gradient(135deg, #16a085, #1abc9c);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
        }

        .middleware-chain {
            display: flex;
            align-items: center;
            justify-content: space-around;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .middleware-step {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin: 5px;
            text-align: center;
            min-width: 120px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .middleware-step:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .middleware-step.active {
            background: rgba(255, 255, 255, 0.4);
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .arrow {
            font-size: 1.5em;
            color: #f1c40f;
            margin: 0 10px;
        }

        .control-panel {
            background: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
        }

        .btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn.danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .btn.success {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
        }

        .btn.warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }

        .database-demo {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
        }

        .message-log {
            background: #000;
            color: #0f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            height: 200px;
            overflow-y: auto;
            border: 2px solid #27ae60;
        }

        .message-input {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }

        .message-input input {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 5px;
            font-size: 1em;
        }

        .knowledge-point {
            background: #f8f9fa;
            border-left: 4px solid #e74c3c;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 10px 10px 0;
        }

        .cultural-info {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            text-align: center;
        }

        .section-title {
            color: #e74c3c;
            margin-top: 40px;
            padding-left: 15px;
            border-left: 5px solid #e74c3c;
            font-size: 1.5em;
        }

        .code-display {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            overflow-x: auto;
            font-size: 0.9em;
        }

        .loading-spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #fff;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 10px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .post-station {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .post-station:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .post-station.active {
            background: rgba(255, 255, 255, 0.3);
            border: 2px solid #f1c40f;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Node.jsæœåŠ¡ç«¯å¼€å‘å®ä¾‹ - å¤ä»£é©¿ç«™ç³»ç»Ÿ</h1>

        <div class="post-station-header">
            ğŸ›ï¸ æ¢ç´¢å¤ä»£é©¿ç«™çš„ä¿¡æ¯ä¼ é€’ä¸ç°ä»£Node.jsæœåŠ¡ç«¯å¼€å‘ ğŸ›ï¸
        </div>

        <div class="knowledge-point">
            <strong>å­¦ä¹ é‡ç‚¹ï¼š</strong>æœ¬é¡µé¢å±•ç¤ºNode.jsçš„æœåŠ¡å™¨åˆ›å»ºã€APIå¼€å‘ã€æ–‡ä»¶ç³»ç»Ÿæ“ä½œã€ä¸­é—´ä»¶å’Œæ•°æ®åº“äº¤äº’
        </div>

        <h2 class="section-title">ğŸ–¥ï¸ HTTPæœåŠ¡å™¨ - é©¿ç«™æ€»éƒ¨</h2>
        <div class="server-demo">
            <h4>ğŸ›ï¸ é©¿ç«™æœåŠ¡å™¨çŠ¶æ€ç›‘æ§</h4>
            <div class="server-status">
                <span>ä¸»æœåŠ¡å™¨ (ç«¯å£ 3000)</span>
                <div class="status-indicator" id="mainServer"></div>
            </div>
            <div class="server-status">
                <span>APIæœåŠ¡å™¨ (ç«¯å£ 8080)</span>
                <div class="status-indicator" id="apiServer"></div>
            </div>
            <div class="server-status">
                <span>æ–‡ä»¶æœåŠ¡å™¨ (ç«¯å£ 8081)</span>
                <div class="status-indicator" id="fileServer"></div>
            </div>
            <div class="control-panel">
                <button class="btn success" onclick="startServer('mainServer')">å¯åŠ¨ä¸»æœåŠ¡å™¨</button>
                <button class="btn warning" onclick="startServer('apiServer')">å¯åŠ¨APIæœåŠ¡å™¨</button>
                <button class="btn" onclick="startServer('fileServer')">å¯åŠ¨æ–‡ä»¶æœåŠ¡å™¨</button>
                <button class="btn danger" onclick="stopAllServers()">åœæ­¢æ‰€æœ‰æœåŠ¡å™¨</button>
            </div>
            <div class="code-display" id="serverCode" style="display: none;"></div>
            <button class="btn" onclick="toggleServerCode()">æŸ¥çœ‹æœåŠ¡å™¨ä»£ç </button>
        </div>

        <h2 class="section-title">ğŸ›£ï¸ APIè·¯ç”± - é©¿ç«™è·¯çº¿ç®¡ç†</h2>
        <div class="api-demo">
            <h4>ğŸ“® é©¿ç«™APIæ¥å£æµ‹è¯•</h4>
            <div class="api-endpoint" onclick="callAPI('GET', '/stations', null)">
                GET /stations - è·å–æ‰€æœ‰é©¿ç«™ä¿¡æ¯
            </div>
            <div class="api-endpoint" onclick="callAPI('POST', '/message', {from: 'é•¿å®‰', to: 'æ´›é˜³', content: 'ç´§æ€¥å†›æƒ…'})">
                POST /message - å‘é€é©¿ç«™æ¶ˆæ¯
            </div>
            <div class="api-endpoint" onclick="callAPI('GET', '/message/status', null)">
                GET /message/status - æŸ¥è¯¢æ¶ˆæ¯çŠ¶æ€
            </div>
            <div class="api-endpoint" onclick="callAPI('PUT', '/station/update', {id: 1, status: 'active'})">
                PUT /station/update - æ›´æ–°é©¿ç«™çŠ¶æ€
            </div>
            <div class="api-response" id="apiResponse">APIå“åº”å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</div>
            <div class="code-display" id="apiCode" style="display: none;"></div>
            <button class="btn" onclick="toggleAPICode()">æŸ¥çœ‹APIä»£ç </button>
        </div>

        <h2 class="section-title">ğŸ“ æ–‡ä»¶ç³»ç»Ÿ - é©¿ç«™æ¡£æ¡ˆç®¡ç†</h2>
        <div class="file-system-demo">
            <h4>ğŸ“š é©¿ç«™æ¡£æ¡ˆç›®å½•ç»“æ„</h4>
            <div class="file-tree" id="fileTree">
                <div class="file-item folder" onclick="toggleFolder(this)">ğŸ“ é©¿ç«™æ¡£æ¡ˆ/</div>
                <div class="file-item folder" onclick="toggleFolder(this)">ğŸ“ å®˜æ–¹æ–‡ä»¶/</div>
                <div class="file-item folder" onclick="toggleFolder(this)">ğŸ“ å•†è´¸è®°å½•/</div>
                <div class="file-item folder" onclick="toggleFolder(this)">ğŸ“ äººå‘˜æ¡£æ¡ˆ/</div>
            </div>
            <div class="control-panel">
                <button class="btn" onclick="readFile()">è¯»å–æ–‡ä»¶</button>
                <button class="btn success" onclick="writeFile()">å†™å…¥æ–‡ä»¶</button>
                <button class="btn warning" onclick="createDirectory()">åˆ›å»ºç›®å½•</button>
                <button class="btn danger" onclick="deleteFile()">åˆ é™¤æ–‡ä»¶</button>
            </div>
            <div class="api-response" id="fileResponse">æ–‡ä»¶æ“ä½œç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</div>
            <div class="code-display" id="fileCode" style="display: none;"></div>
            <button class="btn" onclick="toggleFileCode()">æŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿä»£ç </button>
        </div>

        <h2 class="section-title">âš™ï¸ ä¸­é—´ä»¶ - é©¿ç«™æ£€æŸ¥æµç¨‹</h2>
        <div class="middleware-demo">
            <h4>ğŸ” æ¶ˆæ¯ä¼ é€’ä¸­é—´ä»¶é“¾</h4>
            <div class="middleware-chain">
                <div class="middleware-step" id="auth">ğŸ”<br>èº«ä»½éªŒè¯</div>
                <div class="arrow">â†’</div>
                <div class="middleware-step" id="validate">âœ…<br>æ¶ˆæ¯éªŒè¯</div>
                <div class="arrow">â†’</div>
                <div class="middleware-step" id="log">ğŸ“<br>è®°å½•æ—¥å¿—</div>
                <div class="arrow">â†’</div>
                <div class="middleware-step" id="process">âš¡<br>å¤„ç†è¯·æ±‚</div>
                <div class="arrow">â†’</div>
                <div class="middleware-step" id="response">ğŸ“¤<br>å‘é€å“åº”</div>
            </div>
            <div class="control-panel">
                <button class="btn success" onclick="processMessage()">å¤„ç†æ¶ˆæ¯</button>
                <button class="btn danger" onclick="simulateError()">æ¨¡æ‹Ÿé”™è¯¯</button>
                <button class="btn" onclick="resetMiddleware()">é‡ç½®æµç¨‹</button>
            </div>
            <div class="code-display" id="middlewareCode" style="display: none;"></div>
            <button class="btn" onclick="toggleMiddlewareCode()">æŸ¥çœ‹ä¸­é—´ä»¶ä»£ç </button>
        </div>

        <h2 class="section-title">ğŸ’¾ æ•°æ®å­˜å‚¨ - é©¿ç«™æ¶ˆæ¯ç³»ç»Ÿ</h2>
        <div class="database-demo">
            <h4>ğŸ“¨ å®æ—¶æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿ</h4>
            <div class="message-log" id="messageLog">é©¿ç«™æ¶ˆæ¯ç³»ç»Ÿå·²å¯åŠ¨...
                ç­‰å¾…æ¶ˆæ¯ä¼ é€’...
            </div>
            <div class="message-input">
                <input type="text" id="messageInput" placeholder="è¾“å…¥è¦ä¼ é€’çš„æ¶ˆæ¯..." onkeypress="handleEnter(event)">
                <button class="btn success" onclick="sendMessage()">å‘é€æ¶ˆæ¯</button>
                <button class="btn warning" onclick="clearMessages()">æ¸…ç©ºæ¶ˆæ¯</button>
            </div>
            <div class="control-panel">
                <button class="btn" onclick="simulateTraffic()">æ¨¡æ‹Ÿæ¶ˆæ¯æµé‡</button>
                <button class="btn danger" onclick="emergencyMessage()">ç´§æ€¥æ¶ˆæ¯</button>
            </div>
            <div class="code-display" id="dbCode" style="display: none;"></div>
            <button class="btn" onclick="toggleDBCode()">æŸ¥çœ‹æ•°æ®åº“ä»£ç </button>
        </div>

        <div class="cultural-info">
            <h3>ğŸ›ï¸ ä¸­å›½å¤ä»£é©¿ç«™åˆ¶åº¦</h3>
            <p><strong>é©¿ç«™ç³»ç»Ÿï¼š</strong>ä¸­å›½å¤ä»£é‡è¦çš„é€šä¿¡å’Œäº¤é€šç½‘ç»œï¼Œç¡®ä¿æ”¿ä»¤ä¼ è¾¾å’Œä¿¡æ¯æµé€šã€‚</p>
            <p><strong>å…«ç™¾é‡ŒåŠ æ€¥ï¼š</strong>å¤ä»£æœ€é«˜çº§åˆ«çš„ç´§æ€¥æ–‡ä»¶ä¼ é€’ï¼Œä½“ç°äº†é«˜æ•ˆçš„ä¿¡æ¯ä¼ é€’æœºåˆ¶ã€‚</p>
            <p><strong>é©¿é©¬ä¼ ä¹¦ï¼š</strong>é€šè¿‡é©¿ç«™ç½‘ç»œï¼Œå®ç°äº†è·¨è¶Šåƒé‡Œçš„å¿«é€Ÿé€šä¿¡ã€‚</p>
            <p><strong>åˆ¶åº¦å®Œå–„ï¼š</strong>ä»ç§¦æœå¼€å§‹å»ºç«‹ï¼Œå†ä»£ä¸æ–­å®Œå–„ï¼Œæˆä¸ºå¤ä»£è¡Œæ”¿ç®¡ç†çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚</p>
        </div>

        <div class="knowledge-point">
            <strong>æŠ€æœ¯æ€»ç»“ï¼š</strong>æœ¬é¡µé¢é€šè¿‡å¤ä»£é©¿ç«™ç³»ç»Ÿå±•ç¤ºäº†Node.jsæœåŠ¡ç«¯å¼€å‘çš„æ ¸å¿ƒæ¦‚å¿µï¼š
            <br>â€¢ <strong>HTTPæœåŠ¡å™¨ï¼š</strong>ä½¿ç”¨httpæ¨¡å—åˆ›å»ºæœåŠ¡å™¨ï¼Œå¤„ç†å®¢æˆ·ç«¯è¯·æ±‚
            <br>â€¢ <strong>è·¯ç”±ç³»ç»Ÿï¼š</strong>æ ¹æ®URLè·¯å¾„å’ŒHTTPæ–¹æ³•åˆ†å‘è¯·æ±‚åˆ°å¯¹åº”å¤„ç†å‡½æ•°
            <br>â€¢ <strong>æ–‡ä»¶ç³»ç»Ÿï¼š</strong>ä½¿ç”¨fsæ¨¡å—è¿›è¡Œæ–‡ä»¶è¯»å†™ã€ç›®å½•æ“ä½œç­‰æ–‡ä»¶ç³»ç»Ÿäº¤äº’
            <br>â€¢ <strong>ä¸­é—´ä»¶ï¼š</strong>åœ¨è¯·æ±‚å¤„ç†è¿‡ç¨‹ä¸­æ’å…¥çš„å‡½æ•°ï¼Œç”¨äºèº«ä»½éªŒè¯ã€æ—¥å¿—è®°å½•ç­‰
            <br>â€¢ <strong>å¼‚æ­¥å¤„ç†ï¼š</strong>ä½¿ç”¨å›è°ƒã€Promiseã€async/awaitå¤„ç†å¼‚æ­¥æ“ä½œ
            <br>â€¢ <strong>æ•°æ®æŒä¹…åŒ–ï¼š</strong>ä¸æ•°æ®åº“äº¤äº’ï¼Œå­˜å‚¨å’Œæ£€ç´¢åº”ç”¨æ•°æ®
        </div>
    </div>

    <script>
        // æœåŠ¡å™¨çŠ¶æ€ç®¡ç†
        const serverStatus = {
            mainServer: false,
            apiServer: false,
            fileServer: false
        };

        function startServer(serverId) {
            const indicator = document.getElementById(serverId);
            indicator.classList.add('online');
            serverStatus[serverId] = true;

            // æ¨¡æ‹ŸæœåŠ¡å™¨å¯åŠ¨è¿‡ç¨‹
            const messages = {
                mainServer: 'ä¸»æœåŠ¡å™¨å¯åŠ¨ä¸­...',
                apiServer: 'APIæœåŠ¡å™¨å¯åŠ¨ä¸­...',
                fileServer: 'æ–‡ä»¶æœåŠ¡å™¨å¯åŠ¨ä¸­...'
            };

            logMessage(messages[serverId]);

            setTimeout(() => {
                logMessage(`${messages[serverId].replace('å¯åŠ¨ä¸­', 'å¯åŠ¨å®Œæˆ')} âœ…`);
            }, 1500);
        }

        function stopAllServers() {
            Object.keys(serverStatus).forEach(serverId => {
                const indicator = document.getElementById(serverId);
                indicator.classList.remove('online');
                serverStatus[serverId] = false;
            });
            logMessage('æ‰€æœ‰æœåŠ¡å™¨å·²åœæ­¢ ğŸ›‘');
        }

        function toggleServerCode() {
            const codeDisplay = document.getElementById('serverCode');
            codeDisplay.style.display = codeDisplay.style.display === 'none' ? 'block' : 'none';
            codeDisplay.innerHTML = `
// Node.js HTTPæœåŠ¡å™¨ç¤ºä¾‹
const http = require('http');
const url = require('url');

// åˆ›å»ºHTTPæœåŠ¡å™¨
const server = http.createServer((req, res) => {
    const parsedUrl = url.parse(req.url, true);
    const path = parsedUrl.pathname;
    const method = req.method;
    
    // è®¾ç½®å“åº”å¤´
    res.setHeader('Content-Type', 'application/json');
    res.setHeader('Access-Control-Allow-Origin', '*');
    
    // è·¯ç”±å¤„ç†
    if (path === '/stations' && method === 'GET') {
        handleGetStations(req, res);
    } else if (path === '/message' && method === 'POST') {
        handlePostMessage(req, res);
    } else {
        res.statusCode = 404;
        res.end(JSON.stringify({ error: 'è·¯ç”±æœªæ‰¾åˆ°' }));
    }
});

// å¯åŠ¨æœåŠ¡å™¨
server.listen(3000, () => {
    console.log('é©¿ç«™æœåŠ¡å™¨è¿è¡Œåœ¨ç«¯å£ 3000');
});

// å¤„ç†è·å–é©¿ç«™ä¿¡æ¯
function handleGetStations(req, res) {
    const stations = [
        { id: 1, name: 'é•¿å®‰é©¿ç«™', status: 'active' },
        { id: 2, name: 'æ´›é˜³é©¿ç«™', status: 'active' },
        { id: 3, name: 'å¼€å°é©¿ç«™', status: 'maintenance' }
    ];
    
    res.statusCode = 200;
    res.end(JSON.stringify({ success: true, data: stations }));
}
            `;
        }

        // APIè°ƒç”¨æ¨¡æ‹Ÿ
        function callAPI(method, endpoint, data) {
            const response = document.getElementById('apiResponse');
            response.innerHTML = `<div class="loading-spinner"></div>æ­£åœ¨è°ƒç”¨ ${method} ${endpoint}...`;

            // æ¨¡æ‹ŸAPIå“åº”
            setTimeout(() => {
                const mockResponses = {
                    'GET /stations': {
                        success: true,
                        data: [
                            { id: 1, name: 'é•¿å®‰é©¿ç«™', location: 'é™•è¥¿è¥¿å®‰', status: 'active', horses: 25 },
                            { id: 2, name: 'æ´›é˜³é©¿ç«™', location: 'æ²³å—æ´›é˜³', status: 'active', horses: 18 },
                            { id: 3, name: 'å¼€å°é©¿ç«™', location: 'æ²³å—å¼€å°', status: 'maintenance', horses: 12 }
                        ]
                    },
                    'POST /message': {
                        success: true,
                        messageId: 'MSG_' + Date.now(),
                        status: 'sent',
                        estimatedDelivery: '2å°æ—¶'
                    },
                    'GET /message/status': {
                        success: true,
                        messages: [
                            { id: 'MSG_001', status: 'delivered', from: 'é•¿å®‰', to: 'æ´›é˜³' },
                            { id: 'MSG_002', status: 'in_transit', from: 'æ´›é˜³', to: 'å¼€å°' }
                        ]
                    },
                    'PUT /station/update': {
                        success: true,
                        message: 'é©¿ç«™çŠ¶æ€æ›´æ–°æˆåŠŸ'
                    }
                };

                const key = `${method} ${endpoint}`;
                const mockResponse = mockResponses[key] || { error: 'æœªçŸ¥APIç«¯ç‚¹' };

                response.innerHTML = JSON.stringify(mockResponse, null, 2);
                logMessage(`APIè°ƒç”¨: ${method} ${endpoint} - å“åº”å·²è¿”å›`);
            }, 1000);
        }

        function toggleAPICode() {
            const codeDisplay = document.getElementById('apiCode');
            codeDisplay.style.display = codeDisplay.style.display === 'none' ? 'block' : 'none';
            codeDisplay.innerHTML = `
// Express.js APIè·¯ç”±ç¤ºä¾‹
const express = require('express');
const app = express();

// ä¸­é—´ä»¶
app.use(express.json());
app.use(express.urlencoded({ extended: true }));

// è·å–æ‰€æœ‰é©¿ç«™
app.get('/stations', (req, res) => {
    try {
        const stations = getStationsFromDB();
        res.json({ success: true, data: stations });
    } catch (error) {
        res.status(500).json({ error: error.message });
    }
});

// å‘é€æ¶ˆæ¯
app.post('/message', async (req, res) => {
    try {
        const { from, to, content } = req.body;
        
        // éªŒè¯è¾“å…¥
        if (!from || !to || !content) {
            return res.status(400).json({ 
                error: 'ç¼ºå°‘å¿…è¦å‚æ•°' 
            });
        }
        
        // ä¿å­˜æ¶ˆæ¯åˆ°æ•°æ®åº“
        const message = await saveMessage({ from, to, content });
        
        // å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—
        await sendToQueue(message);
        
        res.json({ 
            success: true, 
            messageId: message.id,
            status: 'sent'
        });
    } catch (error) {
        res.status(500).json({ error: error.message });
    }
});

// å¯åŠ¨æœåŠ¡å™¨
app.listen(8080, () => {
    console.log('APIæœåŠ¡å™¨è¿è¡Œåœ¨ç«¯å£ 8080');
});
            `;
        }

        // æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
        function toggleFolder(element) {
            const isExpanded = element.dataset.expanded === 'true';

            if (!isExpanded) {
                const files = [
                    'ğŸ“„ å®˜æ–¹å…¬æ–‡.txt',
                    'ğŸ“„ å•†è´¸åˆåŒ.pdf',
                    'ğŸ“„ äººå‘˜åå†Œ.xlsx',
                    'ğŸ“„ è´¢åŠ¡è®°å½•.json'
                ];

                files.forEach(file => {
                    const fileElement = document.createElement('div');
                    fileElement.className = 'file-item file';
                    fileElement.textContent = file;
                    fileElement.onclick = () => selectFile(file);
                    element.parentNode.insertBefore(fileElement, element.nextSibling);
                });

                element.dataset.expanded = 'true';
                element.textContent = element.textContent.replace('ğŸ“', 'ğŸ“‚');
            } else {
                // æ”¶èµ·æ–‡ä»¶å¤¹
                let nextElement = element.nextSibling;
                while (nextElement && nextElement.classList.contains('file')) {
                    const toRemove = nextElement;
                    nextElement = nextElement.nextSibling;
                    toRemove.remove();
                }

                element.dataset.expanded = 'false';
                element.textContent = element.textContent.replace('ğŸ“‚', 'ğŸ“');
            }
        }

        function selectFile(fileName) {
            const response = document.getElementById('fileResponse');
            response.innerHTML = `å·²é€‰æ‹©æ–‡ä»¶: ${fileName}`;
        }

        function readFile() {
            const response = document.getElementById('fileResponse');
            response.innerHTML = `<div class="loading-spinner"></div>æ­£åœ¨è¯»å–æ–‡ä»¶...`;

            setTimeout(() => {
                response.innerHTML = `æ–‡ä»¶è¯»å–æˆåŠŸ:
æ–‡ä»¶å: å®˜æ–¹å…¬æ–‡.txt
å¤§å°: 2.5KB
ä¿®æ”¹æ—¶é—´: 2024-01-15 10:30:00
å†…å®¹: å¥‰å¤©æ‰¿è¿ï¼Œçš‡å¸è¯æ›°...`;
                logMessage('æ–‡ä»¶è¯»å–æ“ä½œå®Œæˆ');
            }, 1000);
        }

        function writeFile() {
            const response = document.getElementById('fileResponse');
            response.innerHTML = `<div class="loading-spinner"></div>æ­£åœ¨å†™å…¥æ–‡ä»¶...`;

            setTimeout(() => {
                response.innerHTML = `æ–‡ä»¶å†™å…¥æˆåŠŸ:
æ–°æ–‡ä»¶: æ–°å»ºå…¬æ–‡_${Date.now()}.txt
å†™å…¥å†…å®¹: é©¿ç«™æ—¥å¸¸æŠ¥å‘Š
çŠ¶æ€: å†™å…¥å®Œæˆ âœ…`;
                logMessage('æ–‡ä»¶å†™å…¥æ“ä½œå®Œæˆ');
            }, 1200);
        }

        function createDirectory() {
            const response = document.getElementById('fileResponse');
            response.innerHTML = `ç›®å½•åˆ›å»ºæˆåŠŸ:
æ–°ç›®å½•: ä¸´æ—¶æ–‡ä»¶_${new Date().getFullYear()}
æƒé™: 755
çŠ¶æ€: åˆ›å»ºå®Œæˆ âœ…`;
            logMessage('ç›®å½•åˆ›å»ºæ“ä½œå®Œæˆ');
        }

        function deleteFile() {
            const response = document.getElementById('fileResponse');
            response.innerHTML = `æ–‡ä»¶åˆ é™¤æˆåŠŸ:
åˆ é™¤æ–‡ä»¶: ä¸´æ—¶æ–‡ä»¶.tmp
çŠ¶æ€: åˆ é™¤å®Œæˆ âœ…`;
            logMessage('æ–‡ä»¶åˆ é™¤æ“ä½œå®Œæˆ');
        }

        function toggleFileCode() {
            const codeDisplay = document.getElementById('fileCode');
            codeDisplay.style.display = codeDisplay.style.display === 'none' ? 'block' : 'none';
            codeDisplay.innerHTML = `
// Node.jsæ–‡ä»¶ç³»ç»Ÿæ“ä½œç¤ºä¾‹
const fs = require('fs').promises;
const path = require('path');

// å¼‚æ­¥è¯»å–æ–‡ä»¶
async function readFileAsync(filePath) {
    try {
        const data = await fs.readFile(filePath, 'utf8');
        console.log('æ–‡ä»¶å†…å®¹:', data);
        return data;
    } catch (error) {
        console.error('è¯»å–æ–‡ä»¶å¤±è´¥:', error.message);
        throw error;
    }
}

// å¼‚æ­¥å†™å…¥æ–‡ä»¶
async function writeFileAsync(filePath, content) {
    try {
        await fs.writeFile(filePath, content, 'utf8');
        console.log('æ–‡ä»¶å†™å…¥æˆåŠŸ');
    } catch (error) {
        console.error('å†™å…¥æ–‡ä»¶å¤±è´¥:', error.message);
        throw error;
    }
}

// åˆ›å»ºç›®å½•
async function createDirectoryAsync(dirPath) {
    try {
        await fs.mkdir(dirPath, { recursive: true });
        console.log('ç›®å½•åˆ›å»ºæˆåŠŸ');
    } catch (error) {
        console.error('åˆ›å»ºç›®å½•å¤±è´¥:', error.message);
        throw error;
    }
}

// è¯»å–ç›®å½•å†…å®¹
async function readDirectoryAsync(dirPath) {
    try {
        const files = await fs.readdir(dirPath);
        console.log('ç›®å½•å†…å®¹:', files);
        return files;
    } catch (error) {
        console.error('è¯»å–ç›®å½•å¤±è´¥:', error.message);
        throw error;
    }
}

// æ–‡ä»¶çŠ¶æ€æ£€æŸ¥
async function getFileStatsAsync(filePath) {
    try {
        const stats = await fs.stat(filePath);
        return {
            size: stats.size,
            isFile: stats.isFile(),
            isDirectory: stats.isDirectory(),
            modified: stats.mtime
        };
    } catch (error) {
        console.error('è·å–æ–‡ä»¶çŠ¶æ€å¤±è´¥:', error.message);
        throw error;
    }
}
            `;
        }

        // ä¸­é—´ä»¶æ¼”ç¤º
        function processMessage() {
            resetMiddleware();
            const steps = ['auth', 'validate', 'log', 'process', 'response'];

            steps.forEach((step, index) => {
                setTimeout(() => {
                    const element = document.getElementById(step);
                    element.classList.add('active');

                    setTimeout(() => {
                        element.classList.remove('active');
                        element.style.background = 'rgba(39, 174, 96, 0.8)';
                    }, 800);

                    if (index === steps.length - 1) {
                        setTimeout(() => {
                            logMessage('æ¶ˆæ¯å¤„ç†å®Œæˆï¼Œæ‰€æœ‰ä¸­é—´ä»¶æ‰§è¡ŒæˆåŠŸ âœ…');
                        }, 1000);
                    }
                }, index * 1000);
            });
        }

        function simulateError() {
            resetMiddleware();
            const steps = ['auth', 'validate'];

            steps.forEach((step, index) => {
                setTimeout(() => {
                    const element = document.getElementById(step);
                    element.classList.add('active');

                    setTimeout(() => {
                        element.classList.remove('active');
                        if (index === steps.length - 1) {
                            element.style.background = 'rgba(231, 76, 60, 0.8)';
                            logMessage('ä¸­é—´ä»¶æ‰§è¡Œå¤±è´¥ï¼šæ¶ˆæ¯éªŒè¯é”™è¯¯ âŒ');
                        } else {
                            element.style.background = 'rgba(39, 174, 96, 0.8)';
                        }
                    }, 800);
                }, index * 1000);
            });
        }

        function resetMiddleware() {
            const steps = ['auth', 'validate', 'log', 'process', 'response'];
            steps.forEach(step => {
                const element = document.getElementById(step);
                element.classList.remove('active');
                element.style.background = 'rgba(255, 255, 255, 0.2)';
            });
        }

        function toggleMiddlewareCode() {
            const codeDisplay = document.getElementById('middlewareCode');
            codeDisplay.style.display = codeDisplay.style.display === 'none' ? 'block' : 'none';
            codeDisplay.innerHTML = `
// Express.jsä¸­é—´ä»¶ç¤ºä¾‹
const express = require('express');
const app = express();

// èº«ä»½éªŒè¯ä¸­é—´ä»¶
function authenticateUser(req, res, next) {
    const token = req.headers.authorization;
    
    if (!token) {
        return res.status(401).json({ error: 'ç¼ºå°‘è®¤è¯ä»¤ç‰Œ' });
    }
    
    // éªŒè¯ä»¤ç‰Œ
    try {
        const decoded = jwt.verify(token, process.env.JWT_SECRET);
        req.user = decoded;
        next(); // ç»§ç»­åˆ°ä¸‹ä¸€ä¸ªä¸­é—´ä»¶
    } catch (error) {
        return res.status(401).json({ error: 'æ— æ•ˆä»¤ç‰Œ' });
    }
}

// è¯·æ±‚éªŒè¯ä¸­é—´ä»¶
function validateRequest(req, res, next) {
    const { from, to, content } = req.body;
    
    if (!from || !to || !content) {
        return res.status(400).json({ 
            error: 'è¯·æ±‚å‚æ•°ä¸å®Œæ•´' 
        });
    }
    
    // éªŒè¯é©¿ç«™æ˜¯å¦å­˜åœ¨
    if (!isValidStation(from) || !isValidStation(to)) {
        return res.status(400).json({ 
            error: 'æ— æ•ˆçš„é©¿ç«™' 
        });
    }
    
    next();
}

// æ—¥å¿—è®°å½•ä¸­é—´ä»¶
function logRequest(req, res, next) {
    const timestamp = new Date().toISOString();
    console.log(\`[\${timestamp}] \${req.method} \${req.url}\`);
    
    // è®°å½•è¯·æ±‚å¼€å§‹æ—¶é—´
    req.startTime = Date.now();
    
    // ç›‘å¬å“åº”ç»“æŸäº‹ä»¶
    res.on('finish', () => {
        const duration = Date.now() - req.startTime;
        console.log(\`è¯·æ±‚å¤„ç†è€—æ—¶: \${duration}ms\`);
    });
    
    next();
}

// ä½¿ç”¨ä¸­é—´ä»¶
app.use(express.json());
app.use(logRequest);
app.post('/message', authenticateUser, validateRequest, (req, res) => {
    // å¤„ç†æ¶ˆæ¯å‘é€
    res.json({ success: true, message: 'æ¶ˆæ¯å‘é€æˆåŠŸ' });
});
            `;
        }

        // æ¶ˆæ¯ç³»ç»Ÿ
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();

            if (message) {
                const timestamp = new Date().toLocaleTimeString();
                logMessage(`[${timestamp}] ç”¨æˆ·æ¶ˆæ¯: ${message}`);
                input.value = '';

                // æ¨¡æ‹Ÿæ¶ˆæ¯å¤„ç†
                setTimeout(() => {
                    logMessage(`[${timestamp}] æ¶ˆæ¯å·²é€è¾¾ç›®æ ‡é©¿ç«™ âœ…`);
                }, 1500);
            }
        }

        function handleEnter(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function clearMessages() {
            const log = document.getElementById('messageLog');
            log.innerHTML = 'æ¶ˆæ¯æ—¥å¿—å·²æ¸…ç©º...\n';
        }

        function simulateTraffic() {
            const messages = [
                'é•¿å®‰é©¿ç«™æŠ¥å‘Šï¼šä¸€åˆ‡æ­£å¸¸',
                'æ´›é˜³é©¿ç«™ï¼šå•†é˜Ÿå·²åˆ°è¾¾',
                'å¼€å°é©¿ç«™ï¼šéœ€è¦è¡¥å……é©¬åŒ¹',
                'æ±´æ¢é©¿ç«™ï¼šå¤©æ°”è‰¯å¥½ï¼Œé“è·¯ç•…é€š',
                'ä¸´å®‰é©¿ç«™ï¼šæ”¶åˆ°ç´§æ€¥å…¬æ–‡'
            ];

            messages.forEach((msg, index) => {
                setTimeout(() => {
                    const timestamp = new Date().toLocaleTimeString();
                    logMessage(`[${timestamp}] ç³»ç»Ÿæ¶ˆæ¯: ${msg}`);
                }, index * 800);
            });
        }

        function emergencyMessage() {
            const timestamp = new Date().toLocaleTimeString();
            logMessage(`[${timestamp}] ğŸš¨ ç´§æ€¥æ¶ˆæ¯: å…«ç™¾é‡ŒåŠ æ€¥ï¼è¾¹å¢ƒå†›æƒ…ç´§æ€¥ï¼`);
            logMessage(`[${timestamp}] ğŸš¨ ä¼˜å…ˆçº§: æœ€é«˜ | é¢„è®¡é€è¾¾: 6å°æ—¶`);
        }

        function logMessage(message) {
            const log = document.getElementById('messageLog');
            log.innerHTML += message + '\n';
            log.scrollTop = log.scrollHeight;
        }

        function toggleDBCode() {
            const codeDisplay = document.getElementById('dbCode');
            codeDisplay.style.display = codeDisplay.style.display === 'none' ? 'block' : 'none';
            codeDisplay.innerHTML = `
// MongoDBæ•°æ®åº“æ“ä½œç¤ºä¾‹
const { MongoClient } = require('mongodb');

// è¿æ¥æ•°æ®åº“
async function connectDB() {
    const client = new MongoClient(process.env.MONGODB_URI);
    await client.connect();
    return client.db('postStation');
}

// ä¿å­˜æ¶ˆæ¯
async function saveMessage(messageData) {
    const db = await connectDB();
    const collection = db.collection('messages');
    
    const message = {
        ...messageData,
        timestamp: new Date(),
        status: 'pending',
        id: generateMessageId()
    };
    
    const result = await collection.insertOne(message);
    return { ...message, _id: result.insertedId };
}

// æŸ¥è¯¢æ¶ˆæ¯
async function getMessages(query = {}) {
    const db = await connectDB();
    const collection = db.collection('messages');
    
    return await collection.find(query).toArray();
}

// æ›´æ–°æ¶ˆæ¯çŠ¶æ€
async function updateMessageStatus(messageId, status) {
    const db = await connectDB();
    const collection = db.collection('messages');
    
    return await collection.updateOne(
        { id: messageId },
        { 
            $set: { 
                status: status,
                updatedAt: new Date()
            }
        }
    );
}

// Redisç¼“å­˜ç¤ºä¾‹
const redis = require('redis');
const client = redis.createClient();

// ç¼“å­˜é©¿ç«™ä¿¡æ¯
async function cacheStationInfo(stationId, info) {
    const key = \`station:\${stationId}\`;
    await client.setex(key, 3600, JSON.stringify(info)); // 1å°æ—¶è¿‡æœŸ
}

// è·å–ç¼“å­˜çš„é©¿ç«™ä¿¡æ¯
async function getCachedStationInfo(stationId) {
    const key = \`station:\${stationId}\`;
    const cached = await client.get(key);
    return cached ? JSON.parse(cached) : null;
}
            `;
        }

        // é¡µé¢åŠ è½½æ—¶çš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function () {
            console.log('Node.jsæœåŠ¡ç«¯å¼€å‘é¡µé¢å·²åŠ è½½');
            logMessage('é©¿ç«™ç®¡ç†ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ');
            logMessage('ç­‰å¾…ç”¨æˆ·æ“ä½œ...');
        });
    </script>
</body>

</html>