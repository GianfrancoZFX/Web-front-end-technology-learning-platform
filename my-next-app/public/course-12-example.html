<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Next.jsè¿›é˜¶å¼€å‘ä¸ç»„ä»¶é›†æˆ - å¤ä»£å­¦é™¢ç®¡ç†ç³»ç»Ÿ</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Microsoft YaHei', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #333;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
      color: white;
    }

    .header h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    .header p {
      font-size: 1.2em;
      opacity: 0.9;
    }

    .concept-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 30px;
      margin-bottom: 40px;
    }

    .concept-card {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .concept-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
    }

    .concept-card h3 {
      color: #667eea;
      margin-bottom: 15px;
      font-size: 1.4em;
      border-bottom: 2px solid #f0f0f0;
      padding-bottom: 10px;
    }

    .concept-card p {
      line-height: 1.6;
      margin-bottom: 15px;
      color: #666;
    }

    .code-block {
      background: #f8f9fa;
      border: 1px solid #e9ecef;
      border-radius: 8px;
      padding: 15px;
      margin: 15px 0;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 0.9em;
      overflow-x: auto;
      white-space: pre-wrap;
    }

    .demo-section {
      background: white;
      border-radius: 15px;
      padding: 30px;
      margin: 30px 0;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .demo-section h2 {
      color: #667eea;
      margin-bottom: 20px;
      font-size: 1.8em;
      text-align: center;
    }

    .feature-tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
      justify-content: center;
    }

    .tab-button {
      background: #667eea;
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 25px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.9em;
    }

    .tab-button:hover {
      background: #5a6fd8;
      transform: translateY(-2px);
    }

    .tab-button.active {
      background: #764ba2;
      box-shadow: 0 4px 15px rgba(118, 75, 162, 0.3);
    }

    .tab-content {
      display: none;
      background: #f8f9fa;
      border-radius: 10px;
      padding: 20px;
      margin-top: 20px;
    }

    .tab-content.active {
      display: block;
    }

    .component-demo {
      background: #fff;
      border: 2px solid #667eea;
      border-radius: 10px;
      padding: 20px;
      margin: 20px 0;
    }

    .component-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin: 20px 0;
    }

    .component-card {
      background: white;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      transition: transform 0.2s ease;
    }

    .component-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
    }

    .component-card h4 {
      color: #667eea;
      margin-bottom: 10px;
    }

    .student-card {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
      border-radius: 10px;
      padding: 15px;
      margin: 10px 0;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    .student-card h4 {
      margin-bottom: 8px;
    }

    .student-card p {
      margin: 4px 0;
      opacity: 0.9;
    }

    .course-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-radius: 10px;
      padding: 15px;
      margin: 10px 0;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    .course-card h4 {
      margin-bottom: 8px;
    }

    .course-card p {
      margin: 4px 0;
      opacity: 0.9;
    }

    .status-badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 0.8em;
      font-weight: bold;
    }

    .status-active {
      background: #d4edda;
      color: #155724;
    }

    .status-pending {
      background: #fff3cd;
      color: #856404;
    }

    .status-completed {
      background: #d1ecf1;
      color: #0c5460;
    }

    .control-panel {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
    }

    .control-group {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }

    .control-button {
      background: #28a745;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .control-button:hover {
      background: #218838;
    }

    .control-button.secondary {
      background: #6c757d;
    }

    .control-button.secondary:hover {
      background: #5a6268;
    }

    .control-button.danger {
      background: #dc3545;
    }

    .control-button.danger:hover {
      background: #c82333;
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #333;
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
    }

    .form-group textarea {
      resize: vertical;
      min-height: 80px;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1000;
    }

    .modal.show {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      background: white;
      border-radius: 10px;
      padding: 30px;
      max-width: 500px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
    }

    .modal-header h3 {
      color: #667eea;
      margin: 0;
    }

    .close-button {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #999;
    }

    .close-button:hover {
      color: #333;
    }

    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid #f3f3f3;
      border-top: 3px solid #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    .error-message {
      background: #f8d7da;
      color: #721c24;
      padding: 10px;
      border-radius: 5px;
      margin: 10px 0;
      border: 1px solid #f5c6cb;
    }

    .success-message {
      background: #d4edda;
      color: #155724;
      padding: 10px;
      border-radius: 5px;
      margin: 10px 0;
      border: 1px solid #c3e6cb;
    }

    .pagination {
      display: flex;
      justify-content: center;
      gap: 5px;
      margin: 20px 0;
    }

    .pagination button {
      background: #fff;
      border: 1px solid #ddd;
      padding: 8px 12px;
      cursor: pointer;
      border-radius: 4px;
      transition: all 0.3s ease;
    }

    .pagination button:hover {
      background: #667eea;
      color: white;
    }

    .pagination button.active {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }

    .pagination button:disabled {
      background: #f8f9fa;
      color: #6c757d;
      cursor: not-allowed;
    }

    .search-box {
      position: relative;
      margin-bottom: 20px;
    }

    .search-box input {
      width: 100%;
      padding: 12px 40px 12px 15px;
      border: 2px solid #ddd;
      border-radius: 25px;
      font-size: 16px;
      transition: border-color 0.3s ease;
    }

    .search-box input:focus {
      outline: none;
      border-color: #667eea;
    }

    .search-box::after {
      content: 'ğŸ”';
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 18px;
    }

    @media (max-width: 768px) {
      .concept-grid {
        grid-template-columns: 1fr;
      }

      .feature-tabs {
        flex-direction: column;
      }

      .component-grid {
        grid-template-columns: 1fr;
      }

      .control-group {
        flex-direction: column;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ“ Next.jsè¿›é˜¶å¼€å‘ä¸ç»„ä»¶é›†æˆ</h1>
      <p>é€šè¿‡å¤ä»£å­¦é™¢ç®¡ç†ç³»ç»Ÿå­¦ä¹ Next.jsé«˜çº§ç‰¹æ€§</p>
    </div>

    <div class="concept-grid">
      <div class="concept-card">
        <h3>ğŸ§© é«˜çº§ç»„ä»¶æ¨¡å¼</h3>
        <p>å­¦ä¹ å¤åˆç»„ä»¶ã€æ¸²æŸ“å±æ€§ã€é«˜é˜¶ç»„ä»¶ç­‰é«˜çº§æ¨¡å¼ï¼Œæ„å»ºå¯å¤ç”¨çš„ç»„ä»¶åº“ã€‚</p>
        <div class="code-block">// å¤åˆç»„ä»¶æ¨¡å¼
          const StudentCard = ({ children }) => {
          return <div className="student-card">{children}</div>;
          };

          const StudentName = ({ children }) => {
          return <h4>{children}</h4>;
          };

          const StudentInfo = ({ children }) => {
          return <p>{children}</p>;
          };

          // ç»„åˆä½¿ç”¨
          StudentCard.Name = StudentName;
          StudentCard.Info = StudentInfo;

          // ä½¿ç”¨æ–¹å¼
          <StudentCard>
            <StudentCard.Name>æç™½</StudentCard.Name>
            <StudentCard.Info>è¯—ä»™ï¼Œç››å”è¯—äºº</StudentCard.Info>
          </StudentCard>
        </div>
      </div>

      <div class="concept-card">
        <h3>ğŸ”„ çŠ¶æ€ç®¡ç†è¿›é˜¶</h3>
        <p>ä½¿ç”¨Context APIã€useReducerå’Œè‡ªå®šä¹‰Hooksè¿›è¡Œå¤æ‚çŠ¶æ€ç®¡ç†ã€‚</p>
        <div class="code-block">// å­¦é™¢çŠ¶æ€ç®¡ç†
          const AcademyContext = createContext();

          const academyReducer = (state, action) => {
          switch (action.type) {
          case 'ADD_STUDENT':
          return {
          ...state,
          students: [...state.students, action.payload]
          };
          case 'UPDATE_STUDENT':
          return {
          ...state,
          students: state.students.map(student =>
          student.id === action.payload.id
          ? { ...student, ...action.payload }
          : student
          )
          };
          default:
          return state;
          }
          };

          // è‡ªå®šä¹‰Hook
          function useAcademy() {
          const context = useContext(AcademyContext);
          if (!context) {
          throw new Error('useAcademyå¿…é¡»åœ¨AcademyProviderå†…ä½¿ç”¨');
          }
          return context;
          }</div>
      </div>

      <div class="concept-card">
        <h3>âš¡ æ€§èƒ½ä¼˜åŒ–æŠ€å·§</h3>
        <p>ä½¿ç”¨React.memoã€useMemoã€useCallbackç­‰ä¼˜åŒ–ç»„ä»¶æ€§èƒ½ã€‚</p>
        <div class="code-block">// æ€§èƒ½ä¼˜åŒ–ç¤ºä¾‹
          const StudentList = React.memo(({ students, onStudentClick }) => {
          return (
          <div>
            {students.map(student => (
            <StudentItem key={student.id} student={student} onClick={onStudentClick} />
            ))}
          </div>
          );
          });

          const StudentItem = React.memo(({ student, onClick }) => {
          const handleClick = useCallback(() => {
          onClick(student.id);
          }, [student.id, onClick]);

          const studentInfo = useMemo(() => {
          return {
          ...student,
          fullName: `${student.surname}${student.name}`,
          age: calculateAge(student.birthDate)
          };
          }, [student]);

          return (
          <div onClick={handleClick}>
            <h4>{studentInfo.fullName}</h4>
            <p>å¹´é¾„: {studentInfo.age}</p>
          </div>
          );
          });
        </div>
      </div>

      <div class="concept-card">
        <h3>ğŸ”Œ ç¬¬ä¸‰æ–¹åº“é›†æˆ</h3>
        <p>é›†æˆUIåº“ã€å›¾è¡¨åº“ã€è¡¨å•åº“ç­‰ç¬¬ä¸‰æ–¹ç»„ä»¶ï¼Œæ„å»ºå®Œæ•´åº”ç”¨ã€‚</p>
        <div class="code-block">// é›†æˆç¬¬ä¸‰æ–¹åº“ç¤ºä¾‹
          import { Chart as ChartJS } from 'chart.js';
          import { Line } from 'react-chartjs-2';
          import { useForm } from 'react-hook-form';
          import { toast } from 'react-toastify';

          // å­¦ç”Ÿæˆç»©å›¾è¡¨
          function GradeChart({ data }) {
          const chartData = {
          labels: data.map(item => item.subject),
          datasets: [{
          label: 'æˆç»©',
          data: data.map(item => item.score),
          borderColor: 'rgb(75, 192, 192)',
          tension: 0.1
          }]
          };

          return
          <Line data={chartData} />;
          }

          // è¡¨å•å¤„ç†
          function StudentForm({ onSubmit }) {
          const { register, handleSubmit, formState: { errors } } = useForm();

          const onFormSubmit = (data) => {
          onSubmit(data);
          toast.success('å­¦ç”Ÿä¿¡æ¯ä¿å­˜æˆåŠŸï¼');
          };

          return (
          <form onSubmit={handleSubmit(onFormSubmit)}>
            <input {...register('name', { required: 'å§“åå¿…å¡«' })} placeholder="å­¦ç”Ÿå§“å" />
            {errors.name && <span>{errors.name.message}</span>}
          </form>
          );
          }
        </div>
      </div>
    </div>

    <div class="demo-section">
      <h2>ğŸ“ å¤ä»£å­¦é™¢ç®¡ç†ç³»ç»Ÿæ¼”ç¤º</h2>

      <div class="feature-tabs">
        <button class="tab-button active" onclick="showTab('components')">ç»„ä»¶ç³»ç»Ÿ</button>
        <button class="tab-button" onclick="showTab('state')">çŠ¶æ€ç®¡ç†</button>
        <button class="tab-button" onclick="showTab('performance')">æ€§èƒ½ä¼˜åŒ–</button>
        <button class="tab-button" onclick="showTab('integration')">ç¬¬ä¸‰æ–¹é›†æˆ</button>
      </div>

      <div id="components" class="tab-content active">
        <h3>ğŸ§© é«˜çº§ç»„ä»¶æ¨¡å¼æ¼”ç¤º</h3>
        <p>å±•ç¤ºå¤åˆç»„ä»¶ã€æ¸²æŸ“å±æ€§ã€é«˜é˜¶ç»„ä»¶ç­‰æ¨¡å¼çš„å®é™…åº”ç”¨ã€‚</p>

        <div class="component-demo">
          <h4>å¤åˆç»„ä»¶æ¨¡å¼ - å­¦ç”Ÿå¡ç‰‡</h4>
          <div class="component-grid" id="student-cards">
            <!-- å­¦ç”Ÿå¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
          </div>

          <div class="control-panel">
            <h4>ç»„ä»¶æ§åˆ¶</h4>
            <div class="control-group">
              <button class="control-button" onclick="addStudent()">æ·»åŠ å­¦ç”Ÿ</button>
              <button class="control-button secondary" onclick="toggleStudentInfo()">åˆ‡æ¢è¯¦ç»†ä¿¡æ¯</button>
              <button class="control-button danger" onclick="clearStudents()">æ¸…ç©ºåˆ—è¡¨</button>
            </div>
          </div>
        </div>

        <div class="code-block">// å¤åˆç»„ä»¶å®ç°
          const StudentCard = ({ student, showDetails }) => {
          return (
          <div className="student-card">
            <StudentCard.Header>
              <StudentCard.Name>{student.name}</StudentCard.Name>
              <StudentCard.Badge status={student.status} />
            </StudentCard.Header>

            {showDetails && (
            <StudentCard.Body>
              <StudentCard.Info label="ä¸“ä¸š">{student.major}</StudentCard.Info>
              <StudentCard.Info label="å¹´çº§">{student.grade}</StudentCard.Info>
              <StudentCard.Info label="å¯¼å¸ˆ">{student.mentor}</StudentCard.Info>
            </StudentCard.Body>
            )}

            <StudentCard.Footer>
              <StudentCard.Actions>
                <button onClick={()=> editStudent(student.id)}>ç¼–è¾‘</button>
                <button onClick={()=> viewGrades(student.id)}>æŸ¥çœ‹æˆç»©</button>
              </StudentCard.Actions>
            </StudentCard.Footer>
          </div>
          );
          };

          // é«˜é˜¶ç»„ä»¶ - æ·»åŠ åŠ è½½çŠ¶æ€
          const withLoading = (WrappedComponent) => {
          return function WithLoadingComponent(props) {
          if (props.isLoading) {
          return <div className="loading">åŠ è½½ä¸­...</div>;
          }
          return
          <WrappedComponent {...props} />;
          };
          };

          const StudentListWithLoading = withLoading(StudentList);
        </div>

        <div class="component-demo">
          <h4>æ¸²æŸ“å±æ€§æ¨¡å¼ - è¯¾ç¨‹åˆ—è¡¨</h4>
          <div class="component-grid" id="course-cards">
            <!-- è¯¾ç¨‹å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
          </div>

          <div class="control-panel">
            <div class="control-group">
              <button class="control-button" onclick="loadCourses()">åŠ è½½è¯¾ç¨‹</button>
              <button class="control-button secondary" onclick="filterCourses('active')">ç­›é€‰è¿›è¡Œä¸­</button>
              <button class="control-button secondary" onclick="filterCourses('completed')">ç­›é€‰å·²å®Œæˆ</button>
              <button class="control-button secondary" onclick="filterCourses('all')">æ˜¾ç¤ºå…¨éƒ¨</button>
            </div>
          </div>
        </div>

        <div class="code-block">// æ¸²æŸ“å±æ€§æ¨¡å¼
          const CourseProvider = ({ children }) => {
          const [courses, setCourses] = useState([]);
          const [loading, setLoading] = useState(false);
          const [filter, setFilter] = useState('all');

          const filteredCourses = useMemo(() => {
          if (filter === 'all') return courses;
          return courses.filter(course => course.status === filter);
          }, [courses, filter]);

          const loadCourses = async () => {
          setLoading(true);
          try {
          const data = await fetchCourses();
          setCourses(data);
          } finally {
          setLoading(false);
          }
          };

          return children({
          courses: filteredCourses,
          loading,
          filter,
          setFilter,
          loadCourses
          });
          };

          // ä½¿ç”¨æ¸²æŸ“å±æ€§
          <CourseProvider>
            {({ courses, loading, filter, setFilter, loadCourses }) => (
            <div>
              <CourseFilter filter={filter} onFilterChange={setFilter} />
              {loading ? (
              <LoadingSpinner />
              ) : (
              <CourseList courses={courses} />
              )}
            </div>
            )}
          </CourseProvider>
        </div>
      </div>

      <div id="state" class="tab-content">
        <h3>ğŸ”„ å¤æ‚çŠ¶æ€ç®¡ç†æ¼”ç¤º</h3>
        <p>ä½¿ç”¨Context APIå’ŒuseReducerç®¡ç†å­¦é™¢çš„å¤æ‚çŠ¶æ€ã€‚</p>

        <div class="component-demo">
          <h4>å­¦é™¢çŠ¶æ€ç®¡ç†ä¸­å¿ƒ</h4>

          <div class="search-box">
            <input type="text" placeholder="æœç´¢å­¦ç”Ÿæˆ–è¯¾ç¨‹..." id="search-input" oninput="handleSearch(event)">
          </div>

          <div class="control-panel">
            <h4>çŠ¶æ€æ“ä½œ</h4>
            <div class="control-group">
              <button class="control-button" onclick="dispatchAction('LOAD_STUDENTS')">åŠ è½½å­¦ç”Ÿ</button>
              <button class="control-button" onclick="dispatchAction('LOAD_COURSES')">åŠ è½½è¯¾ç¨‹</button>
              <button class="control-button secondary" onclick="dispatchAction('TOGGLE_LOADING')">åˆ‡æ¢åŠ è½½çŠ¶æ€</button>
              <button class="control-button danger" onclick="dispatchAction('RESET_STATE')">é‡ç½®çŠ¶æ€</button>
            </div>

            <div class="form-group">
              <label>æ·»åŠ æ–°å­¦ç”Ÿ</label>
              <input type="text" id="student-name" placeholder="å­¦ç”Ÿå§“å">
              <input type="text" id="student-major" placeholder="ä¸“ä¸š">
              <button class="control-button" onclick="addNewStudent()">æ·»åŠ å­¦ç”Ÿ</button>
            </div>
          </div>

          <div id="state-display" class="component-grid">
            <!-- çŠ¶æ€æ˜¾ç¤ºåŒºåŸŸ -->
          </div>
        </div>

        <div class="code-block">// å¤æ‚çŠ¶æ€ç®¡ç†å®ç°
          const initialState = {
          students: [],
          courses: [],
          loading: false,
          error: null,
          filters: {
          searchTerm: '',
          status: 'all',
          grade: 'all'
          },
          ui: {
          selectedStudent: null,
          showModal: false,
          currentPage: 1,
          itemsPerPage: 10
          }
          };

          const academyReducer = (state, action) => {
          switch (action.type) {
          case 'LOAD_STUDENTS_START':
          return { ...state, loading: true, error: null };

          case 'LOAD_STUDENTS_SUCCESS':
          return {
          ...state,
          loading: false,
          students: action.payload
          };

          case 'LOAD_STUDENTS_ERROR':
          return {
          ...state,
          loading: false,
          error: action.payload
          };

          case 'ADD_STUDENT':
          return {
          ...state,
          students: [...state.students, {
          id: Date.now(),
          ...action.payload,
          createdAt: new Date().toISOString()
          }]
          };

          case 'UPDATE_STUDENT':
          return {
          ...state,
          students: state.students.map(student =>
          student.id === action.payload.id
          ? { ...student, ...action.payload, updatedAt: new Date().toISOString() }
          : student
          )
          };

          case 'DELETE_STUDENT':
          return {
          ...state,
          students: state.students.filter(student => student.id !== action.payload)
          };

          case 'SET_FILTER':
          return {
          ...state,
          filters: { ...state.filters, ...action.payload }
          };

          case 'SET_UI_STATE':
          return {
          ...state,
          ui: { ...state.ui, ...action.payload }
          };

          case 'RESET_STATE':
          return initialState;

          default:
          return state;
          }
          };

          // Context Provider
          const AcademyProvider = ({ children }) => {
          const [state, dispatch] = useReducer(academyReducer, initialState);

          // é€‰æ‹©å™¨å‡½æ•°
          const selectors = useMemo(() => ({
          getFilteredStudents: () => {
          let filtered = state.students;

          if (state.filters.searchTerm) {
          filtered = filtered.filter(student =>
          student.name.toLowerCase().includes(state.filters.searchTerm.toLowerCase()) ||
          student.major.toLowerCase().includes(state.filters.searchTerm.toLowerCase())
          );
          }

          if (state.filters.status !== 'all') {
          filtered = filtered.filter(student => student.status === state.filters.status);
          }

          return filtered;
          },

          getPaginatedStudents: () => {
          const filtered = selectors.getFilteredStudents();
          const startIndex = (state.ui.currentPage - 1) * state.ui.itemsPerPage;
          return filtered.slice(startIndex, startIndex + state.ui.itemsPerPage);
          },

          getTotalPages: () => {
          const filtered = selectors.getFilteredStudents();
          return Math.ceil(filtered.length / state.ui.itemsPerPage);
          }
          }), [state]);

          const value = {
          state,
          dispatch,
          selectors
          };

          return (
          <AcademyContext.Provider value={value}>
            {children}
          </AcademyContext.Provider>
          );
          };
        </div>
      </div>

      <div id="performance" class="tab-content">
        <h3>âš¡ æ€§èƒ½ä¼˜åŒ–æ¼”ç¤º</h3>
        <p>å±•ç¤ºReactæ€§èƒ½ä¼˜åŒ–æŠ€å·§çš„å®é™…æ•ˆæœã€‚</p>

        <div class="component-demo">
          <h4>æ€§èƒ½ç›‘æ§é¢æ¿</h4>

          <div class="control-panel">
            <div class="control-group">
              <button class="control-button" onclick="startPerformanceTest()">å¼€å§‹æ€§èƒ½æµ‹è¯•</button>
              <button class="control-button secondary" onclick="toggleOptimization()">åˆ‡æ¢ä¼˜åŒ–</button>
              <button class="control-button danger" onclick="clearPerformanceData()">æ¸…é™¤æ•°æ®</button>
            </div>

            <div class="form-group">
              <label>æ¸²æŸ“é¡¹ç›®æ•°é‡</label>
              <input type="range" id="item-count" min="100" max="5000" value="1000" oninput="updateItemCount(event)">
              <span id="item-count-display">1000</span>
            </div>
          </div>

          <div id="performance-results" class="component-grid">
            <!-- æ€§èƒ½æµ‹è¯•ç»“æœ -->
          </div>
        </div>

        <div class="code-block">// æ€§èƒ½ä¼˜åŒ–æŠ€å·§

          // 1. React.memo - é˜²æ­¢ä¸å¿…è¦çš„é‡æ¸²æŸ“
          const StudentItem = React.memo(({ student, onEdit, onDelete }) => {
          console.log(`æ¸²æŸ“å­¦ç”Ÿ: ${student.name}`);

          return (
          <div className="student-item">
            <h4>{student.name}</h4>
            <p>{student.major}</p>
            <button onClick={()=> onEdit(student.id)}>ç¼–è¾‘</button>
            <button onClick={()=> onDelete(student.id)}>åˆ é™¤</button>
          </div>
          );
          }, (prevProps, nextProps) => {
          // è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°
          return (
          prevProps.student.id === nextProps.student.id &&
          prevProps.student.name === nextProps.student.name &&
          prevProps.student.major === nextProps.student.major
          );
          });

          // 2. useMemo - ç¼“å­˜è®¡ç®—ç»“æœ
          const StudentStatistics = ({ students }) => {
          const statistics = useMemo(() => {
          console.log('è®¡ç®—ç»Ÿè®¡æ•°æ®...');

          const totalStudents = students.length;
          const majorCounts = students.reduce((acc, student) => {
          acc[student.major] = (acc[student.major] || 0) + 1;
          return acc;
          }, {});

          const averageAge = students.reduce((sum, student) => {
          return sum + calculateAge(student.birthDate);
          }, 0) / totalStudents;

          return {
          totalStudents,
          majorCounts,
          averageAge: Math.round(averageAge * 100) / 100
          };
          }, [students]);

          return (
          <div>
            <h3>å­¦ç”Ÿç»Ÿè®¡</h3>
            <p>æ€»äººæ•°: {statistics.totalStudents}</p>
            <p>å¹³å‡å¹´é¾„: {statistics.averageAge}</p>
            <div>
              <h4>ä¸“ä¸šåˆ†å¸ƒ:</h4>
              {Object.entries(statistics.majorCounts).map(([major, count]) => (
              <p key={major}>{major}: {count}äºº</p>
              ))}
            </div>
          </div>
          );
          };

          // 3. useCallback - ç¼“å­˜å‡½æ•°å¼•ç”¨
          const StudentList = ({ students }) => {
          const [selectedStudents, setSelectedStudents] = useState(new Set());

          const handleStudentSelect = useCallback((studentId) => {
          setSelectedStudents(prev => {
          const newSet = new Set(prev);
          if (newSet.has(studentId)) {
          newSet.delete(studentId);
          } else {
          newSet.add(studentId);
          }
          return newSet;
          });
          }, []);

          const handleBatchDelete = useCallback(() => {
          // æ‰¹é‡åˆ é™¤é€»è¾‘
          console.log('åˆ é™¤é€‰ä¸­çš„å­¦ç”Ÿ:', Array.from(selectedStudents));
          }, [selectedStudents]);

          return (
          <div>
            <button onClick={handleBatchDelete}>
              åˆ é™¤é€‰ä¸­ ({selectedStudents.size})
            </button>
            {students.map(student => (
            <StudentItem key={student.id} student={student} isSelected={selectedStudents.has(student.id)}
              onSelect={handleStudentSelect} />
            ))}
          </div>
          );
          };

          // 4. è™šæ‹ŸåŒ–é•¿åˆ—è¡¨
          const VirtualizedStudentList = ({ students }) => {
          const [visibleRange, setVisibleRange] = useState({ start: 0, end: 50 });
          const containerRef = useRef();

          const handleScroll = useCallback(() => {
          const container = containerRef.current;
          if (!container) return;

          const scrollTop = container.scrollTop;
          const itemHeight = 60; // æ¯ä¸ªé¡¹ç›®çš„é«˜åº¦
          const containerHeight = container.clientHeight;

          const start = Math.floor(scrollTop / itemHeight);
          const end = Math.min(
          start + Math.ceil(containerHeight / itemHeight) + 5,
          students.length
          );

          setVisibleRange({ start, end });
          }, [students.length]);

          const visibleStudents = students.slice(visibleRange.start, visibleRange.end);

          return (
          <div ref={containerRef} style={{ height: '400px' , overflow: 'auto' }} onScroll={handleScroll}>
            <div style={{ height: visibleRange.start * 60 }} />
            {visibleStudents.map(student => (
            <StudentItem key={student.id} student={student} />
            ))}
            <div style={{ height: (students.length - visibleRange.end) * 60 }} />
          </div>
          );
          };
        </div>
      </div>

      <div id="integration" class="tab-content">
        <h3>ğŸ”Œ ç¬¬ä¸‰æ–¹åº“é›†æˆæ¼”ç¤º</h3>
        <p>å±•ç¤ºå¦‚ä½•é›†æˆå’Œä½¿ç”¨å„ç§ç¬¬ä¸‰æ–¹åº“ã€‚</p>

        <div class="component-demo">
          <h4>å›¾è¡¨åº“é›†æˆ - å­¦ç”Ÿæˆç»©åˆ†æ</h4>

          <div class="control-panel">
            <div class="control-group">
              <button class="control-button" onclick="generateChartData('line')">æŠ˜çº¿å›¾</button>
              <button class="control-button" onclick="generateChartData('bar')">æŸ±çŠ¶å›¾</button>
              <button class="control-button" onclick="generateChartData('pie')">é¥¼å›¾</button>
              <button class="control-button secondary" onclick="exportChart()">å¯¼å‡ºå›¾è¡¨</button>
            </div>
          </div>

          <div id="chart-container"
            style="height: 300px; background: #f8f9fa; border-radius: 8px; display: flex; align-items: center; justify-content: center; margin: 20px 0;">
            <p>ç‚¹å‡»æŒ‰é’®ç”Ÿæˆå›¾è¡¨</p>
          </div>
        </div>

        <div class="component-demo">
          <h4>è¡¨å•åº“é›†æˆ - å­¦ç”Ÿä¿¡æ¯è¡¨å•</h4>

          <form id="student-form" onsubmit="handleFormSubmit(event)">
            <div class="form-group">
              <label>å­¦ç”Ÿå§“å *</label>
              <input type="text" name="name" required>
              <div class="error-message" id="name-error" style="display: none;"></div>
            </div>

            <div class="form-group">
              <label>ä¸“ä¸š *</label>
              <select name="major" required>
                <option value="">è¯·é€‰æ‹©ä¸“ä¸š</option>
                <option value="è¯—è¯å­¦">è¯—è¯å­¦</option>
                <option value="ä¹¦æ³•å­¦">ä¹¦æ³•å­¦</option>
                <option value="éŸ³å¾‹å­¦">éŸ³å¾‹å­¦</option>
                <option value="å¤©æ–‡å­¦">å¤©æ–‡å­¦</option>
                <option value="åŒ»å­¦">åŒ»å­¦</option>
              </select>
            </div>

            <div class="form-group">
              <label>å¹´çº§</label>
              <select name="grade">
                <option value="ä¸€å¹´çº§">ä¸€å¹´çº§</option>
                <option value="äºŒå¹´çº§">äºŒå¹´çº§</option>
                <option value="ä¸‰å¹´çº§">ä¸‰å¹´çº§</option>
                <option value="å››å¹´çº§">å››å¹´çº§</option>
              </select>
            </div>

            <div class="form-group">
              <label>ä¸ªäººç®€ä»‹</label>
              <textarea name="bio" placeholder="è¯·è¾“å…¥ä¸ªäººç®€ä»‹..."></textarea>
            </div>

            <div class="control-group">
              <button type="submit" class="control-button">æäº¤è¡¨å•</button>
              <button type="button" class="control-button secondary" onclick="resetForm()">é‡ç½®</button>
              <button type="button" class="control-button secondary" onclick="validateForm()">éªŒè¯è¡¨å•</button>
            </div>
          </form>

          <div id="form-result" style="margin-top: 20px;"></div>
        </div>

        <div class="code-block">// ç¬¬ä¸‰æ–¹åº“é›†æˆç¤ºä¾‹

          // 1. Chart.js é›†æˆ
          import {
          Chart as ChartJS,
          CategoryScale,
          LinearScale,
          PointElement,
          LineElement,
          BarElement,
          ArcElement,
          Title,
          Tooltip,
          Legend,
          } from 'chart.js';
          import { Line, Bar, Pie } from 'react-chartjs-2';

          ChartJS.register(
          CategoryScale,
          LinearScale,
          PointElement,
          LineElement,
          BarElement,
          ArcElement,
          Title,
          Tooltip,
          Legend
          );

          const GradeChart = ({ data, type = 'line' }) => {
          const chartData = {
          labels: data.map(item => item.subject),
          datasets: [{
          label: 'å¹³å‡æˆç»©',
          data: data.map(item => item.averageScore),
          backgroundColor: [
          'rgba(255, 99, 132, 0.2)',
          'rgba(54, 162, 235, 0.2)',
          'rgba(255, 205, 86, 0.2)',
          'rgba(75, 192, 192, 0.2)',
          'rgba(153, 102, 255, 0.2)',
          ],
          borderColor: [
          'rgba(255, 99, 132, 1)',
          'rgba(54, 162, 235, 1)',
          'rgba(255, 205, 86, 1)',
          'rgba(75, 192, 192, 1)',
          'rgba(153, 102, 255, 1)',
          ],
          borderWidth: 1
          }]
          };

          const options = {
          responsive: true,
          plugins: {
          legend: {
          position: 'top',
          },
          title: {
          display: true,
          text: 'å­¦ç”Ÿæˆç»©åˆ†æå›¾è¡¨'
          }
          }
          };

          switch (type) {
          case 'bar':
          return
          <Bar data={chartData} options={options} />;
          case 'pie':
          return
          <Pie data={chartData} options={options} />;
          default:
          return
          <Line data={chartData} options={options} />;
          }
          };

          // 2. React Hook Form é›†æˆ
          import { useForm, Controller } from 'react-hook-form';
          import { yupResolver } from '@hookform/resolvers/yup';
          import * as yup from 'yup';

          const schema = yup.object({
          name: yup.string().required('å§“åæ˜¯å¿…å¡«é¡¹'),
          major: yup.string().required('è¯·é€‰æ‹©ä¸“ä¸š'),
          grade: yup.string(),
          bio: yup.string().max(500, 'ç®€ä»‹ä¸èƒ½è¶…è¿‡500å­—')
          });

          const StudentForm = ({ onSubmit }) => {
          const {
          register,
          handleSubmit,
          control,
          formState: { errors, isSubmitting },
          reset,
          watch
          } = useForm({
          resolver: yupResolver(schema),
          defaultValues: {
          name: '',
          major: '',
          grade: 'ä¸€å¹´çº§',
          bio: ''
          }
          });

          const watchedValues = watch();

          const onFormSubmit = async (data) => {
          try {
          await onSubmit(data);
          toast.success('å­¦ç”Ÿä¿¡æ¯ä¿å­˜æˆåŠŸï¼');
          reset();
          } catch (error) {
          toast.error('ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•');
          }
          };

          return (
          <form onSubmit={handleSubmit(onFormSubmit)}>
            <div className="form-group">
              <label>å­¦ç”Ÿå§“å *</label>
              <input {...register('name')} className={errors.name ? 'error' : '' } />
              {errors.name && (
              <span className="error-message">{errors.name.message}</span>
              )}
            </div>

            <div className="form-group">
              <label>ä¸“ä¸š *</label>
              <Controller name="major" control={control} render={({ field })=> (
                <select {...field} className={errors.major ? 'error' : '' }>
                  <option value="">è¯·é€‰æ‹©ä¸“ä¸š</option>
                  <option value="è¯—è¯å­¦">è¯—è¯å­¦</option>
                  <option value="ä¹¦æ³•å­¦">ä¹¦æ³•å­¦</option>
                  <option value="éŸ³å¾‹å­¦">éŸ³å¾‹å­¦</option>
                </select>
                )}
                />
                {errors.major && (
                <span className="error-message">{errors.major.message}</span>
                )}
            </div>

            <div className="form-group">
              <label>ä¸ªäººç®€ä»‹ ({watchedValues.bio?.length || 0}/500)</label>
              <textarea {...register('bio')} className={errors.bio ? 'error' : '' } />
              {errors.bio && (
              <span className="error-message">{errors.bio.message}</span>
              )}
            </div>

            <button type="submit" disabled={isSubmitting}>
              {isSubmitting ? 'ä¿å­˜ä¸­...' : 'ä¿å­˜'}
            </button>
          </form>
          );
          };

          // 3. React Toastify é›†æˆ
          import { toast, ToastContainer } from 'react-toastify';
          import 'react-toastify/dist/ReactToastify.css';

          const App = () => {
          const handleSuccess = () => {
          toast.success('æ“ä½œæˆåŠŸï¼', {
          position: "top-right",
          autoClose: 3000,
          hideProgressBar: false,
          closeOnClick: true,
          pauseOnHover: true,
          draggable: true
          });
          };

          const handleError = () => {
          toast.error('æ“ä½œå¤±è´¥ï¼Œè¯·é‡è¯•', {
          position: "top-right",
          autoClose: 5000
          });
          };

          return (
          <div>
            {/* åº”ç”¨å†…å®¹ */}
            <ToastContainer position="top-right" autoClose={3000} hideProgressBar={false} newestOnTop={false}
              closeOnClick rtl={false} pauseOnFocusLoss draggable pauseOnHover />
          </div>
          );
          };
        </div>
      </div>
    </div>
  </div>

  <!-- æ¨¡æ€æ¡† -->
  <div id="modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modal-title">æ ‡é¢˜</h3>
        <button class="close-button" onclick="closeModal()">&times;</button>
      </div>
      <div id="modal-body">
        <!-- æ¨¡æ€æ¡†å†…å®¹ -->
      </div>
    </div>
  </div>

  <script>
    // æ¨¡æ‹Ÿæ•°æ®
    let students = [
      { id: 1, name: 'æç™½', major: 'è¯—è¯å­¦', grade: 'å››å¹´çº§', status: 'active', mentor: 'æœç”«', bio: 'è¯—ä»™ï¼Œæ“…é•¿æµªæ¼«ä¸»ä¹‰è¯—æ­Œ' },
      { id: 2, name: 'æœç”«', major: 'è¯—è¯å­¦', grade: 'å››å¹´çº§', status: 'active', mentor: 'éŸ©æ„ˆ', bio: 'è¯—åœ£ï¼Œç°å®ä¸»ä¹‰è¯—æ­Œå¤§å¸ˆ' },
      { id: 3, name: 'ç‹ç¾²ä¹‹', major: 'ä¹¦æ³•å­¦', grade: 'ä¸‰å¹´çº§', status: 'active', mentor: 'é’Ÿç¹‡', bio: 'ä¹¦åœ£ï¼Œè¡Œä¹¦ã€Šå…°äº­åºã€‹ä¼ ä¸–' },
      { id: 4, name: 'åµ‡åº·', major: 'éŸ³å¾‹å­¦', grade: 'äºŒå¹´çº§', status: 'pending', mentor: 'é˜®ç±', bio: 'ç«¹æ—ä¸ƒè´¤ä¹‹ä¸€ï¼Œç²¾é€šéŸ³å¾‹' },
      { id: 5, name: 'å¼ ä»²æ™¯', major: 'åŒ»å­¦', grade: 'å››å¹´çº§', status: 'active', mentor: 'åä½—', bio: 'åŒ»åœ£ï¼Œè‘—æœ‰ã€Šä¼¤å¯’æ‚ç—…è®ºã€‹' }
    ];

    let courses = [
      { id: 1, name: 'è¯—è¯åˆ›ä½œåŸºç¡€', instructor: 'æœç”«', status: 'active', students: 25, duration: '16å‘¨' },
      { id: 2, name: 'ä¹¦æ³•æŠ€æ³•è¿›é˜¶', instructor: 'ç‹ç¾²ä¹‹', status: 'active', students: 18, duration: '12å‘¨' },
      { id: 3, name: 'å¤å…¸éŸ³å¾‹ç†è®º', instructor: 'åµ‡åº·', status: 'completed', students: 15, duration: '10å‘¨' },
      { id: 4, name: 'ä¸­åŒ»åŸºç¡€ç†è®º', instructor: 'å¼ ä»²æ™¯', status: 'active', students: 22, duration: '20å‘¨' },
      { id: 5, name: 'å¤©æ–‡è§‚æµ‹å®è·µ', instructor: 'éƒ­å®ˆæ•¬', status: 'pending', students: 12, duration: '8å‘¨' }
    ];

    let showDetails = false;
    let optimizationEnabled = true;
    let currentFilter = 'all';
    let performanceData = [];

    // æ ‡ç­¾åˆ‡æ¢
    function showTab(tabName) {
      const contents = document.querySelectorAll('.tab-content');
      contents.forEach(content => content.classList.remove('active'));

      const buttons = document.querySelectorAll('.tab-button');
      buttons.forEach(button => button.classList.remove('active'));

      document.getElementById(tabName).classList.add('active');
      event.target.classList.add('active');
    }

    // å­¦ç”Ÿç®¡ç†åŠŸèƒ½
    function renderStudents() {
      const container = document.getElementById('student-cards');
      if (!container) return;

      container.innerHTML = students.map(student => `
                <div class="student-card">
                    <h4>${student.name}</h4>
                    <p>ä¸“ä¸š: ${student.major}</p>
                    ${showDetails ? `
                        <p>å¹´çº§: ${student.grade}</p>
                        <p>å¯¼å¸ˆ: ${student.mentor}</p>
                        <p>ç®€ä»‹: ${student.bio}</p>
                    ` : ''}
                    <span class="status-badge status-${student.status}">
                        ${getStatusText(student.status)}
                    </span>
                </div>
            `).join('');
    }

    function addStudent() {
      const newStudent = {
        id: Date.now(),
        name: `å­¦ç”Ÿ${students.length + 1}`,
        major: ['è¯—è¯å­¦', 'ä¹¦æ³•å­¦', 'éŸ³å¾‹å­¦', 'åŒ»å­¦', 'å¤©æ–‡å­¦'][Math.floor(Math.random() * 5)],
        grade: ['ä¸€å¹´çº§', 'äºŒå¹´çº§', 'ä¸‰å¹´çº§', 'å››å¹´çº§'][Math.floor(Math.random() * 4)],
        status: 'active',
        mentor: 'å¾…åˆ†é…',
        bio: 'æ–°å…¥å­¦å­¦ç”Ÿ'
      };
      students.push(newStudent);
      renderStudents();
    }

    function toggleStudentInfo() {
      showDetails = !showDetails;
      renderStudents();
    }

    function clearStudents() {
      students = [];
      renderStudents();
    }

    // è¯¾ç¨‹ç®¡ç†åŠŸèƒ½
    function renderCourses() {
      const container = document.getElementById('course-cards');
      if (!container) return;

      const filteredCourses = currentFilter === 'all'
        ? courses
        : courses.filter(course => course.status === currentFilter);

      container.innerHTML = filteredCourses.map(course => `
                <div class="course-card">
                    <h4>${course.name}</h4>
                    <p>è®²å¸ˆ: ${course.instructor}</p>
                    <p>å­¦ç”Ÿæ•°: ${course.students}äºº</p>
                    <p>è¯¾ç¨‹æ—¶é•¿: ${course.duration}</p>
                    <span class="status-badge status-${course.status}">
                        ${getStatusText(course.status)}
                    </span>
                </div>
            `).join('');
    }

    function loadCourses() {
      // æ¨¡æ‹ŸåŠ è½½
      const container = document.getElementById('course-cards');
      container.innerHTML = '<div class="loading"></div><p>åŠ è½½è¯¾ç¨‹ä¸­...</p>';

      setTimeout(() => {
        renderCourses();
      }, 1000);
    }

    function filterCourses(filter) {
      currentFilter = filter;
      renderCourses();
    }

    // çŠ¶æ€ç®¡ç†æ¼”ç¤º
    function dispatchAction(actionType) {
      const display = document.getElementById('state-display');

      switch (actionType) {
        case 'LOAD_STUDENTS':
          display.innerHTML = `
                        <div class="component-card">
                            <h4>å­¦ç”Ÿæ•°æ®å·²åŠ è½½</h4>
                            <p>æ€»æ•°: ${students.length}</p>
                            <p>æ´»è·ƒ: ${students.filter(s => s.status === 'active').length}</p>
                            <p>å¾…å®¡æ ¸: ${students.filter(s => s.status === 'pending').length}</p>
                        </div>
                    `;
          break;

        case 'LOAD_COURSES':
          display.innerHTML = `
                        <div class="component-card">
                            <h4>è¯¾ç¨‹æ•°æ®å·²åŠ è½½</h4>
                            <p>æ€»æ•°: ${courses.length}</p>
                            <p>è¿›è¡Œä¸­: ${courses.filter(c => c.status === 'active').length}</p>
                            <p>å·²å®Œæˆ: ${courses.filter(c => c.status === 'completed').length}</p>
                        </div>
                    `;
          break;

        case 'TOGGLE_LOADING':
          display.innerHTML = `
                        <div class="component-card">
                            <h4>åŠ è½½çŠ¶æ€</h4>
                            <div class="loading"></div>
                            <p>æ­£åœ¨å¤„ç†è¯·æ±‚...</p>
                        </div>
                    `;
          break;

        case 'RESET_STATE':
          display.innerHTML = `
                        <div class="component-card">
                            <h4>çŠ¶æ€å·²é‡ç½®</h4>
                            <p>æ‰€æœ‰æ•°æ®å·²æ¸…ç©º</p>
                        </div>
                    `;
          break;
      }
    }

    function addNewStudent() {
      const name = document.getElementById('student-name').value;
      const major = document.getElementById('student-major').value;

      if (!name || !major) {
        alert('è¯·å¡«å†™å­¦ç”Ÿå§“åå’Œä¸“ä¸š');
        return;
      }

      const newStudent = {
        id: Date.now(),
        name,
        major,
        grade: 'ä¸€å¹´çº§',
        status: 'pending',
        mentor: 'å¾…åˆ†é…',
        bio: 'æ–°å…¥å­¦å­¦ç”Ÿ'
      };

      students.push(newStudent);

      document.getElementById('student-name').value = '';
      document.getElementById('student-major').value = '';

      dispatchAction('LOAD_STUDENTS');
    }

    function handleSearch(event) {
      const searchTerm = event.target.value.toLowerCase();
      const display = document.getElementById('state-display');

      if (!searchTerm) {
        display.innerHTML = '<p>è¾“å…¥å…³é”®è¯å¼€å§‹æœç´¢...</p>';
        return;
      }

      const filteredStudents = students.filter(student =>
        student.name.toLowerCase().includes(searchTerm) ||
        student.major.toLowerCase().includes(searchTerm)
      );

      const filteredCourses = courses.filter(course =>
        course.name.toLowerCase().includes(searchTerm) ||
        course.instructor.toLowerCase().includes(searchTerm)
      );

      display.innerHTML = `
                <div class="component-card">
                    <h4>æœç´¢ç»“æœ</h4>
                    <p>æ‰¾åˆ°å­¦ç”Ÿ: ${filteredStudents.length}äºº</p>
                    <p>æ‰¾åˆ°è¯¾ç¨‹: ${filteredCourses.length}é—¨</p>
                    ${filteredStudents.map(s => `<p>â€¢ ${s.name} (${s.major})</p>`).join('')}
                    ${filteredCourses.map(c => `<p>â€¢ ${c.name} (${c.instructor})</p>`).join('')}
                </div>
            `;
    }

    // æ€§èƒ½ä¼˜åŒ–æ¼”ç¤º
    function startPerformanceTest() {
      const results = document.getElementById('performance-results');
      const itemCount = parseInt(document.getElementById('item-count').value);

      results.innerHTML = '<div class="loading"></div><p>æ­£åœ¨è¿›è¡Œæ€§èƒ½æµ‹è¯•...</p>';

      setTimeout(() => {
        const withOptimization = optimizationEnabled ? Math.random() * 50 + 20 : Math.random() * 200 + 100;
        const withoutOptimization = Math.random() * 200 + 100;

        performanceData.push({
          itemCount,
          withOptimization: Math.round(withOptimization),
          withoutOptimization: Math.round(withoutOptimization),
          improvement: Math.round(((withoutOptimization - withOptimization) / withoutOptimization) * 100)
        });

        results.innerHTML = `
                    <div class="component-card">
                        <h4>æ€§èƒ½æµ‹è¯•ç»“æœ</h4>
                        <p>æµ‹è¯•é¡¹ç›®æ•°: ${itemCount}</p>
                        <p>ä¼˜åŒ–åæ¸²æŸ“æ—¶é—´: ${Math.round(withOptimization)}ms</p>
                        <p>ä¼˜åŒ–å‰æ¸²æŸ“æ—¶é—´: ${Math.round(withoutOptimization)}ms</p>
                        <p>æ€§èƒ½æå‡: ${Math.round(((withoutOptimization - withOptimization) / withoutOptimization) * 100)}%</p>
                    </div>
                    <div class="component-card">
                        <h4>ä¼˜åŒ–æŠ€æœ¯</h4>
                        <p>âœ… React.memo</p>
                        <p>âœ… useMemo</p>
                        <p>âœ… useCallback</p>
                        <p>âœ… è™šæ‹ŸåŒ–åˆ—è¡¨</p>
                    </div>
                `;
      }, 2000);
    }

    function toggleOptimization() {
      optimizationEnabled = !optimizationEnabled;
      const button = event.target;
      button.textContent = optimizationEnabled ? 'ç¦ç”¨ä¼˜åŒ–' : 'å¯ç”¨ä¼˜åŒ–';
    }

    function updateItemCount(event) {
      document.getElementById('item-count-display').textContent = event.target.value;
    }

    function clearPerformanceData() {
      performanceData = [];
      document.getElementById('performance-results').innerHTML = '<p>æ€§èƒ½æ•°æ®å·²æ¸…é™¤</p>';
    }

    // å›¾è¡¨æ¼”ç¤º
    function generateChartData(type) {
      const container = document.getElementById('chart-container');

      const subjects = ['è¯—è¯å­¦', 'ä¹¦æ³•å­¦', 'éŸ³å¾‹å­¦', 'åŒ»å­¦', 'å¤©æ–‡å­¦'];
      const scores = subjects.map(() => Math.floor(Math.random() * 40) + 60);

      let chartHTML = '';

      switch (type) {
        case 'line':
          chartHTML = `
                        <div style="width: 100%; height: 100%; padding: 20px;">
                            <h4>å­¦ç§‘æˆç»©è¶‹åŠ¿å›¾</h4>
                            <svg width="100%" height="200" style="border: 1px solid #ddd;">
                                ${subjects.map((subject, index) => {
            const x = (index + 1) * (100 / (subjects.length + 1));
            const y = 180 - (scores[index] - 60) * 3;
            return `
                                        <circle cx="${x}%" cy="${y}" r="4" fill="#667eea" />
                                        <text x="${x}%" y="195" text-anchor="middle" font-size="12">${subject}</text>
                                        <text x="${x}%" y="${y - 10}" text-anchor="middle" font-size="10">${scores[index]}</text>
                                        ${index > 0 ? `<line x1="${(index) * (100 / (subjects.length + 1))}%" y1="${180 - (scores[index - 1] - 60) * 3}" x2="${x}%" y2="${y}" stroke="#667eea" stroke-width="2" />` : ''}
                                    `;
          }).join('')}
                            </svg>
                        </div>
                    `;
          break;

        case 'bar':
          chartHTML = `
                        <div style="width: 100%; height: 100%; padding: 20px;">
                            <h4>å­¦ç§‘æˆç»©æŸ±çŠ¶å›¾</h4>
                            <div style="display: flex; align-items: end; height: 200px; gap: 10px;">
                                ${subjects.map((subject, index) => {
            const height = (scores[index] - 60) * 3;
            return `
                                        <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                            <div style="background: #667eea; width: 100%; height: ${height}px; margin-bottom: 5px; border-radius: 4px 4px 0 0; position: relative;">
                                                <span style="position: absolute; top: -20px; left: 50%; transform: translateX(-50%); font-size: 12px;">${scores[index]}</span>
                                            </div>
                                            <span style="font-size: 12px; text-align: center;">${subject}</span>
                                        </div>
                                    `;
          }).join('')}
                            </div>
                        </div>
                    `;
          break;

        case 'pie':
          const total = scores.reduce((sum, score) => sum + score, 0);
          let currentAngle = 0;
          const colors = ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF'];

          chartHTML = `
                        <div style="width: 100%; height: 100%; padding: 20px;">
                            <h4>å­¦ç§‘æˆç»©åˆ†å¸ƒé¥¼å›¾</h4>
                            <div style="display: flex; align-items: center; gap: 20px;">
                                <svg width="200" height="200">
                                    ${subjects.map((subject, index) => {
            const percentage = scores[index] / total;
            const angle = percentage * 360;
            const startAngle = currentAngle;
            currentAngle += angle;

            const x1 = 100 + 80 * Math.cos((startAngle - 90) * Math.PI / 180);
            const y1 = 100 + 80 * Math.sin((startAngle - 90) * Math.PI / 180);
            const x2 = 100 + 80 * Math.cos((startAngle + angle - 90) * Math.PI / 180);
            const y2 = 100 + 80 * Math.sin((startAngle + angle - 90) * Math.PI / 180);

            const largeArcFlag = angle > 180 ? 1 : 0;

            return `
                                            <path d="M 100 100 L ${x1} ${y1} A 80 80 0 ${largeArcFlag} 1 ${x2} ${y2} Z" 
                                                  fill="${colors[index]}" stroke="white" stroke-width="2" />
                                        `;
          }).join('')}
                                </svg>
                                <div>
                                    ${subjects.map((subject, index) => `
                                        <div style="display: flex; align-items: center; margin: 5px 0;">
                                            <div style="width: 16px; height: 16px; background: ${colors[index]}; margin-right: 8px;"></div>
                                            <span style="font-size: 12px;">${subject}: ${scores[index]}åˆ†</span>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    `;
          break;
      }

      container.innerHTML = chartHTML;
    }

    function exportChart() {
      alert('å›¾è¡¨å¯¼å‡ºåŠŸèƒ½ï¼ˆå®é™…é¡¹ç›®ä¸­å¯ä»¥ä½¿ç”¨html2canvasç­‰åº“å®ç°ï¼‰');
    }

    // è¡¨å•å¤„ç†
    function handleFormSubmit(event) {
      event.preventDefault();

      const formData = new FormData(event.target);
      const data = Object.fromEntries(formData.entries());

      // ç®€å•éªŒè¯
      if (!data.name || !data.major) {
        showFormError('è¯·å¡«å†™å¿…å¡«é¡¹');
        return;
      }

      // æ¨¡æ‹Ÿæäº¤
      const result = document.getElementById('form-result');
      result.innerHTML = `
                <div class="success-message">
                    <h4>è¡¨å•æäº¤æˆåŠŸï¼</h4>
                    <p><strong>å§“å:</strong> ${data.name}</p>
                    <p><strong>ä¸“ä¸š:</strong> ${data.major}</p>
                    <p><strong>å¹´çº§:</strong> ${data.grade}</p>
                    <p><strong>ç®€ä»‹:</strong> ${data.bio || 'æ— '}</p>
                </div>
            `;

      // æ·»åŠ åˆ°å­¦ç”Ÿåˆ—è¡¨
      const newStudent = {
        id: Date.now(),
        name: data.name,
        major: data.major,
        grade: data.grade,
        status: 'pending',
        mentor: 'å¾…åˆ†é…',
        bio: data.bio || 'æ— ç®€ä»‹'
      };
      students.push(newStudent);
    }

    function resetForm() {
      document.getElementById('student-form').reset();
      document.getElementById('form-result').innerHTML = '';
      clearFormErrors();
    }

    function validateForm() {
      const form = document.getElementById('student-form');
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());

      clearFormErrors();

      let isValid = true;

      if (!data.name) {
        showFieldError('name', 'å§“åæ˜¯å¿…å¡«é¡¹');
        isValid = false;
      }

      if (!data.major) {
        showFieldError('major', 'è¯·é€‰æ‹©ä¸“ä¸š');
        isValid = false;
      }

      if (data.bio && data.bio.length > 500) {
        showFieldError('bio', 'ç®€ä»‹ä¸èƒ½è¶…è¿‡500å­—');
        isValid = false;
      }

      const result = document.getElementById('form-result');
      if (isValid) {
        result.innerHTML = '<div class="success-message">è¡¨å•éªŒè¯é€šè¿‡ï¼</div>';
      } else {
        result.innerHTML = '<div class="error-message">è¡¨å•éªŒè¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥é”™è¯¯ä¿¡æ¯</div>';
      }
    }

    function showFormError(message) {
      const result = document.getElementById('form-result');
      result.innerHTML = `<div class="error-message">${message}</div>`;
    }

    function showFieldError(fieldName, message) {
      const errorElement = document.getElementById(`${fieldName}-error`);
      if (errorElement) {
        errorElement.textContent = message;
        errorElement.style.display = 'block';
      }
    }

    function clearFormErrors() {
      const errorElements = document.querySelectorAll('.error-message');
      errorElements.forEach(element => {
        element.style.display = 'none';
        element.textContent = '';
      });
    }

    // æ¨¡æ€æ¡†
    function openModal(title, content) {
      document.getElementById('modal-title').textContent = title;
      document.getElementById('modal-body').innerHTML = content;
      document.getElementById('modal').classList.add('show');
    }

    function closeModal() {
      document.getElementById('modal').classList.remove('show');
    }

    // å·¥å…·å‡½æ•°
    function getStatusText(status) {
      const statusMap = {
        'active': 'æ´»è·ƒ',
        'pending': 'å¾…å®¡æ ¸',
        'completed': 'å·²å®Œæˆ',
        'closed': 'å·²å…³é—­'
      };
      return statusMap[status] || status;
    }

    // åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', function () {
      renderStudents();
      renderCourses();
    });

    // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
    document.getElementById('modal').addEventListener('click', function (event) {
      if (event.target === this) {
        closeModal();
      }
    });
  </script>
</body>

</html>